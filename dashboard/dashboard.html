<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Convergio Dashboard</title>
  <link rel="icon" type="image/png" href="assets/favicon.png">
  <link rel="stylesheet" href="css/fonts.css">
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/simplified-nav.css">
  <link rel="stylesheet" href="css/mobile.css">
  <link rel="stylesheet" href="css/unified-waves.css">
  <link rel="stylesheet" href="css/wave-menu.css">
  <link rel="stylesheet" href="css/conversation-viewer.css">
  <link rel="stylesheet" href="css/loading.css">
  <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
  <!-- Toast Container -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Notification Triggers Modal -->
  <div class="modal-overlay" id="triggerModal" style="display:none;">
    <div class="modal-content trigger-modal">
      <div class="modal-header">
        <h3>Notification Triggers</h3>
        <button class="modal-close" onclick="closeTriggerModal()">&times;</button>
      </div>
      <div class="modal-body">
        <p class="modal-description">Configure which events trigger notifications:</p>
        <div class="trigger-list" id="triggerList">
          <div class="trigger-loading">Loading...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Top Navigation -->
  <nav class="top-nav">

    <button class="hamburger-menu" id="hamburgerMenu" aria-label="Toggle menu" title="Menu">
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
      <span class="hamburger-line"></span>
    </button>
    <div class="nav-menu" id="navMenu">
      <a href="#" onclick="showView('kanban')" title="Mission Control - Overview of all projects and plans">
        Control Center
      </a>
      <a href="#" id="dashboardLink" class="disabled" onclick="showView('dashboard')" title="Dashboard - Current project metrics and progress">
        Dashboard
      </a>
    </div>
    <div class="nav-right">
      <button class="nav-icon-btn" id="bugTrackerBtn" onclick="toggleBugTracker()" title="Track bugs and issues">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <rect x="5" y="6" width="14" height="14" rx="2"/>
          <path d="M9 3h6M12 3v3"/>
          <path d="M10 11h6M10 15h6"/>
          <path d="M8 11h.01M8 15h.01"/>
        </svg>
        <span class="nav-icon-label">Track Issues</span>
        <span class="bug-count" id="bugCount">0</span>
      </button>
      
      <button class="nav-icon-btn" onclick="refreshControlCenter()" title="Refresh data">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="23 4 23 10 17 10"/>
          <polyline points="1 20 1 14 7 14"/>
          <path d="M3.51 9a9 9 0 0 1 14.13-3.36L23 10"/>
          <path d="M20.49 15a9 9 0 0 1-14.13 3.36L1 14"/>
        </svg>
        <span class="nav-icon-label">Refresh</span>
      </button>
      
      <button class="nav-icon-btn" id="notificationsBtn" onclick="toggleNotificationsOverlay()" title="View all notifications">
        <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M6.5 8a5.5 5.5 0 0 1 11 0c0 5 1.5 7 1.5 7H5s1.5-2 1.5-7"/>
          <path d="M10 19a2 2 0 0 0 4 0"/>
        </svg>
        <span class="nav-icon-label">Notifications</span>
        <span class="notification-count hidden" id="notificationCount">0</span>
      </button>
      
      <div class="settings-menu-wrapper">
        <button class="nav-icon-btn" id="settingsBtn" onclick="toggleSettingsMenu()" title="Settings">
          <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="4"/>
            <path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/>
          </svg>
          <span class="nav-icon-label">Settings</span>
        </button>
        <div class="settings-dropdown" id="settingsDropdown" style="display:none;">
          <div class="settings-section">
            <div class="settings-label">Theme</div>
            <select id="themeSelect" onchange="switchTheme(this.value)">
              <option value="voltrex">Voltrex</option>
              <option value="midnight">Midnight</option>
              <option value="frost">Frost</option>
              <option value="dawn">Dawn</option>
            </select>
          </div>
          <button class="settings-item" id="exportBtn" onclick="exportData()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/>
            </svg>
            Export Data
          </button>
          <button class="settings-item danger" onclick="shutdownDashboard()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18.36 6.64a9 9 0 1 1-12.73 0M12 2v10"/>
            </svg>
            Shutdown
          </button>
        </div>
      </div>
      
      <div class="system-status-compact" id="systemStatusCompact" title="Active missions in flight">
        <div class="status-dot" id="ccStatusDot"></div>
        <span class="status-count" id="ccStatusCount">0</span>
      </div>
    </div>
  </nav>

  <!-- Main Layout -->
  <div class="main-wrap">
    <!-- Left Git Panel (VS Code Style) -->
    <aside class="git-panel" id="gitPanel">
      <div class="git-panel-header">
        <span>SOURCE CONTROL</span>
        <div class="git-panel-actions">
          <button class="git-header-btn" onclick="gitFetch()" title="Refresh">&#x21BB;</button>
          <button class="git-header-btn" onclick="showGitMenu(event)" title="More">&#x22EF;</button>
        </div>
      </div>

      <!-- REPOSITORIES Section -->
      <div class="git-section">
        <div class="git-section-header" onclick="toggleGitSection('repos')">
          <span class="git-arrow">&#x25BC;</span>
          <span>REPOSITORIES</span>
        </div>
        <div class="git-section-content" id="gitRepos">
          <div class="git-repo-item" id="gitRepoItem">
            <img class="git-repo-avatar" id="gitRepoAvatar" src="" alt="" style="display:none;">
            <svg class="git-repo-icon" id="gitRepoIconFallback" width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
              <path fill-rule="evenodd" d="M2 2.5A2.5 2.5 0 014.5 0h8.75a.75.75 0 01.75.75v12.5a.75.75 0 01-.75.75h-2.5a.75.75 0 110-1.5h1.75v-2h-8a1 1 0 00-.714 1.7.75.75 0 01-1.072 1.05A2.495 2.495 0 012 11.5v-9zm10.5-1V9h-8c-.356 0-.694.074-1 .208V2.5a1 1 0 011-1h8zM5 12.25v3.25a.25.25 0 00.4.2l1.45-1.087a.25.25 0 01.3 0L8.6 15.7a.25.25 0 00.4-.2v-3.25a.25.25 0 00-.25-.25h-3.5a.25.25 0 00-.25.25z"/>
            </svg>
            <span class="git-repo-name" id="gitRepoName">Project</span>
            <span class="git-repo-branch" id="gitRepoBranch" onclick="showBranchMenu()">
              <span class="branch-icon">&#x2387;</span>
              <span id="gitCurrentBranchName">main</span>
              <span class="branch-dirty" id="gitBranchDirty">*</span>
            </span>
            <button class="git-repo-action" onclick="gitFetch()" title="Fetch">&#x21BB;</button>
            <button class="git-repo-action" onclick="showRepoMenu(event)" title="More">&#x22EF;</button>
          </div>
          <div class="git-branch-list" id="gitBranchList"></div>
        </div>
      </div>

      <!-- CHANGES Section -->
      <div class="git-section git-changes-section">
        <div class="git-section-header" onclick="toggleGitSection('changes')">
          <span class="git-arrow">&#x25BC;</span>
          <span>CHANGES</span>
          <span class="git-badge" id="gitChangesCount">0</span>
        </div>
        <div class="git-section-content" id="gitChanges">
          <!-- Commit Message -->
          <div class="git-commit-box">
            <input type="text" class="git-commit-input" id="gitCommitMessage" placeholder="Message (&#x2318;Enter to commit on &quot;main&quot;)">
            <div class="git-commit-btn-wrap">
              <button class="git-commit-btn" onclick="commitChanges()">
                <span class="commit-icon">&#x1F512;</span> Commit
              </button>
              <button class="git-commit-dropdown" onclick="showCommitMenu(event)">&#x25BC;</button>
            </div>
          </div>
          <!-- File Tree -->
          <div class="git-tree" id="gitFileTree"></div>
        </div>
      </div>

      <!-- GRAPH Section -->
      <div class="git-section git-graph-section">
        <div class="git-section-header" onclick="toggleGitSection('graph')">
          <span class="git-arrow">&#x25BC;</span>
          <span>GRAPH</span>
          <div class="git-graph-actions">
            <button class="git-graph-btn" id="gitShowAllBranches" onclick="toggleAllBranches()" title="Show all branches">All</button>
            <button class="git-graph-btn" onclick="gitFetch()" title="Fetch">&#x2193;</button>
            <button class="git-graph-btn" onclick="gitPull()" title="Pull">&#x2193;&#x2193;</button>
            <button class="git-graph-btn" onclick="gitPush()" title="Push">&#x2191;</button>
          </div>
        </div>
        <div class="git-section-content git-graph-content" id="gitGraphSection">
          <div class="git-graph-container" id="gitGraphContainer"></div>
        </div>
      </div>
    </aside>

      <!-- Control Center (Full-Page Kanban) -->
      <div class="control-center" id="kanbanView" style="display:none;">
        <!-- Metrics Dashboard -->
        <div class="cc-metrics">
          <div class="cc-metric" onclick="openProjectMenu()">
            <div class="cc-metric-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"/></svg></div>
            <div class="cc-metric-value blue" id="kanbanTotalProjects">0</div>
            <div class="cc-metric-label">Projects</div>
          </div>
          <div class="cc-metric" onclick="scrollToKanban()">
            <div class="cc-metric-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M8 7h8M8 12h8M8 17h5"/></svg></div>
            <div class="cc-metric-value" id="kanbanTotalPlans">0</div>
            <div class="cc-metric-label">Total Plans</div>
          </div>
          <div class="cc-metric" onclick="scrollToKanban('doing')">
            <div class="cc-metric-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M12 6v6l4 2"/></svg></div>
            <div class="cc-metric-value orange" id="kanbanActivePlans">0</div>
            <div class="cc-metric-label">Active</div>
          </div>
          <div class="cc-metric" onclick="scrollToKanban('done')">
            <div class="cc-metric-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg></div>
            <div class="cc-metric-value green" id="kanbanCompletedPlans">0</div>
            <div class="cc-metric-label">Completed</div>
          </div>
          <div class="cc-metric" onclick="showTokensBreakdown()">
            <div class="cc-metric-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg></div>
            <div class="cc-metric-value" id="kanbanTotalTokens">0</div>
            <div class="cc-metric-label">Tokens</div>
          </div>
          <div class="cc-metric" onclick="showTokensBreakdown()">
            <div class="cc-metric-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
            <div class="cc-metric-value red" id="kanbanTotalCost">$0</div>
            <div class="cc-metric-label">Cost</div>
          </div>
        </div>

        <!-- Gauges Row -->
        <div class="cc-gauges">
          <div class="cc-gauge-card">
            <div class="cc-gauge-title">Completion Rate</div>
            <div class="cc-gauge">
              <div class="cc-gauge-bg">
                <div class="cc-gauge-fill green" id="gaugeCompletion" style="transform: rotate(-90deg) scaleX(0.5);"></div>
              </div>
              <div class="cc-gauge-value" id="gaugeCompletionValue">0%</div>
            </div>
            <div class="cc-gauge-label">Plans Completed</div>
          </div>
          <div class="cc-gauge-card">
            <div class="cc-gauge-title">Active Workload</div>
            <div class="cc-gauge">
              <div class="cc-gauge-bg">
                <div class="cc-gauge-fill orange" id="gaugeWorkload" style="transform: rotate(-90deg) scaleX(0);"></div>
              </div>
              <div class="cc-gauge-value" id="gaugeWorkloadValue">0</div>
            </div>
            <div class="cc-gauge-label">Plans in Progress</div>
          </div>
          <div class="cc-gauge-card">
            <div class="cc-gauge-title">Efficiency Score</div>
            <div class="cc-gauge">
              <div class="cc-gauge-bg">
                <div class="cc-gauge-fill blue" id="gaugeEfficiency" style="transform: rotate(-90deg) scaleX(0.75);"></div>
              </div>
              <div class="cc-gauge-value" id="gaugeEfficiencyValue">-</div>
            </div>
            <div class="cc-gauge-label">Avg Tokens/Task</div>
          </div>
        </div>

        <!-- Kanban Section -->
        <div class="cc-kanban">
          <div class="cc-kanban-header">
            <div class="cc-kanban-title">Mission Pipeline</div>
          </div>
          <div class="cc-kanban-grid">
            <div class="cc-kanban-column" data-status="todo">
              <div class="cc-column-header">
                <div class="cc-column-title">
                  <span class="cc-column-dot todo"></span>
                  <span>QUEUE</span>
                </div>
                <span class="cc-column-count" id="kanbanTodoCount">0</span>
              </div>
              <div class="cc-column-cards" id="kanbanTodo"></div>
            </div>
            <div class="cc-kanban-column" data-status="doing">
              <div class="cc-column-header">
                <div class="cc-column-title">
                  <span class="cc-column-dot doing"></span>
                  <span>IN FLIGHT</span>
                </div>
                <span class="cc-column-count" id="kanbanDoingCount">0</span>
              </div>
              <div class="cc-column-cards" id="kanbanDoing"></div>
            </div>
            <div class="cc-kanban-column" data-status="done">
              <div class="cc-column-header">
                <div class="cc-column-title">
                  <span class="cc-column-dot done"></span>
                  <span>LANDED</span>
                </div>
                <span class="cc-column-count" id="kanbanDoneCount">0</span>
              </div>
              <div class="cc-column-cards" id="kanbanDone"></div>
            </div>
            <!-- Trash Column -->
            <div class="cc-kanban-column trash-column" data-status="trash">
              <div class="cc-column-header">
                <div class="cc-column-title">
                  <span class="cc-column-dot trash">üóëÔ∏è</span>
                  <span>TRASH</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <span class="cc-column-count" id="kanbanTrashCount">0</span>
                  <button class="trash-empty-icon" id="emptyTrashBtn" onclick="emptyTrash()" style="display:none;" title="Empty Trash">
                    üóëÔ∏è
                  </button>
                </div>
              </div>
              <div class="cc-column-cards" id="kanbanTrash"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content -->
     <main class="main-content">
       <!-- Stats Label with Project Avatar -->
       <div class="stats-header">
         <img src="" alt="" class="project-avatar" id="projectAvatar" style="display:none;">
         <div class="stats-label" id="planLabel">Select Project</div>
       </div>

       <!-- Stats Row -->
       <div class="stats-row" id="statsRow">
        <div class="stat-item">
          <div class="label">Tasks Completed</div>
          <div class="value green" id="tasksDone">Loading...</div>
        </div>
        <div class="stat-item">
          <div class="label">AI Tokens Used</div>
          <div class="value" id="tokensUsed">Loading...</div>
        </div>
        <div class="stat-item">
          <div class="label">Avg Tokens/Task</div>
          <div class="value" id="avgTokensPerTask">Loading...</div>
        </div>
        <div class="stat-item">
          <div class="label">Overall Progress</div>
          <div class="value" id="progressPercent">Loading...</div>
        </div>
      </div>

      <!-- Interactive Gantt View - Heart of Dashboard -->
      <div class="interactive-gantt" id="interactiveGantt">
        <div class="gantt-header-section">
          <h3 class="gantt-main-title">Project Execution Timeline</h3>
          <div class="gantt-controls-panel">
            <button class="gantt-control-btn" onclick="GanttView.expandAll()" title="Expand all waves">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="12" x2="15" y2="12"/><line x1="12" y1="9" x2="12" y2="15"/></svg>
            </button>
            <button class="gantt-control-btn" onclick="GanttView.collapseAll()" title="Collapse all waves">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="9" y1="12" x2="15" y2="12"/></svg>
            </button>
            <button class="gantt-control-btn" onclick="GanttView.refresh()" title="Refresh data">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"/></svg>
            </button>
            <div class="gantt-filter-divider"></div>
            <button class="gantt-filter-btn active" id="filterCompleted" onclick="GanttView.toggleCompletedTasks()" title="Show/hide completed tasks">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
            </button>
            <button class="gantt-filter-btn active" id="filterBlocked" onclick="GanttView.toggleBlockedTasks()" title="Show/hide blocked tasks">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/></svg>
            </button>
          </div>
        </div>

        <div class="gantt-timeline-header" id="gantt-timeline-header">
          <div class="gantt-header-info">WAVE / TASK</div>
          <div class="gantt-header-timeline"></div>
        </div>

         <div class="gantt-content-area" id="ganttContentArea">
           <div class="gantt-loading-state">
             <div class="gantt-loading-spinner"></div>
             <div class="gantt-loading-text">Loading project timeline...</div>
           </div>
         </div>
       </div>

       <!-- Empty State Message -->
       <div class="empty-state" id="emptyState" style="display:none;">
         <div class="empty-state-icon">üìä</div>
         <div class="empty-state-title">No Project Data Available</div>
         <div class="empty-state-description">
           Select a project from the menu above or create a new plan to see dashboard metrics.
         </div>
       </div>

       <!-- Chart Card - Token Usage -->
       <div class="chart-card">
        <div class="chart-header">
          <div class="chart-tabs">
            <div class="chart-tab active" onclick="switchChartMode('tokens')">Tokens</div>
            <div class="chart-tab" onclick="switchChartMode('burndown')">Burndown</div>
          </div>
          <div class="chart-filter" id="chartFilter" onclick="showChartFilterMenu(event)">
            <span id="chartFilterLabel">&#x1F4C5; All time</span> &#x25BE;
            <div class="chart-filter-menu" id="chartFilterMenu">
              <div class="chart-filter-option active" data-range="all" onclick="setChartFilter('all', event)">All time</div>
              <div class="chart-filter-option" data-range="30d" onclick="setChartFilter('30d', event)">Last 30 days</div>
              <div class="chart-filter-option" data-range="7d" onclick="setChartFilter('7d', event)">Last 7 days</div>
              <div class="chart-filter-option" data-range="1d" onclick="setChartFilter('1d', event)">Last 24 hours</div>
              <div class="chart-filter-option" data-range="1h" onclick="setChartFilter('1h', event)">Last hour</div>
              <div class="chart-filter-option" data-range="30m" onclick="setChartFilter('30m', event)">Last 30 min</div>
            </div>
          </div>
        </div>
        <div class="token-chart-legend" id="chartLegend">
          <div class="token-chart-legend-item">
            <span class="token-chart-legend-dot input"></span>
            <span>Input: <span id="legendInputTokens">0</span></span>
          </div>
          <div class="token-chart-legend-item">
            <span class="token-chart-legend-dot output"></span>
            <span>Output: <span id="legendOutputTokens">0</span></span>
          </div>
          <span style="margin-left:auto;color:var(--text-muted);">Total: <span id="legendTotalTokens" style="color:var(--green);font-weight:700;">0</span></span>
        </div>
        <div id="mainChart"></div>
      </div>

      <!-- Agents Section -->
      <div class="traders-section">
        <div class="traders-header">Agents Performance</div>
        <div class="traders-grid" id="agentsGrid"></div>
      </div>
    </main>

    <!-- Notifications View -->
    <main class="view" id="notificationsView" style="display: none;">
      <div class="notifications-container">
        <div class="notifications-header">
          <h2>Notifications</h2>
          <div class="notifications-actions">
            <button class="notifications-action-btn" onclick="markAllNotificationsRead()">
              <span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="9" />
                  <path d="M8.5 12.5l2.5 2.5 5-5" />
                </svg>
              </span>
              Mark All Read
            </button>
            <button class="notifications-action-btn danger" onclick="clearAllNotifications()">
              <span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 6h18"/>
                  <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                  <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
                  <path d="M10 11v6M14 11v6"/>
                </svg>
              </span>
              Clear All
            </button>
          </div>
        </div>
        <div class="notifications-filters">
          <button class="notification-filter-btn active" data-filter="all" onclick="filterNotifications('all')">All</button>
          <button class="notification-filter-btn" data-filter="unread" onclick="filterNotifications('unread')">Unread</button>
          <button class="notification-filter-btn" data-filter="info" onclick="filterNotifications('info')">Info</button>
          <button class="notification-filter-btn" data-filter="success" onclick="filterNotifications('success')">Success</button>
          <button class="notification-filter-btn" data-filter="warning" onclick="filterNotifications('warning')">Warning</button>
          <button class="notification-filter-btn" data-filter="error" onclick="filterNotifications('error')">Error</button>
        </div>
        <div class="notifications-list" id="notificationsList">
          <div class="notifications-empty">No notifications</div>
        </div>
      </div>
    </main>

    <!-- Notifications Overlay -->
    <div class="notifications-overlay" id="notificationsOverlay" style="display: none;">
      <div class="notifications-overlay-backdrop" onclick="closeNotificationsOverlay()"></div>
      <div class="notifications-panel">
        <div class="notifications-header">
          <h2>Notifications</h2>
          <div class="notifications-actions">
            <button class="notifications-action-btn" onclick="markAllNotificationsRead()">
              <span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                  <circle cx="12" cy="12" r="9" />
                  <path d="M8.5 12.5l2.5 2.5 5-5" />
                </svg>
              </span>
              Mark All Read
            </button>
            <button class="notifications-action-btn danger" onclick="clearAllNotifications()">
              <span>
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M3 6h18"/>
                  <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                  <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
                  <path d="M10 11v6M14 11v6"/>
                </svg>
              </span>
              Clear All
            </button>
            <button class="notifications-close-btn" onclick="closeNotificationsOverlay()">‚úï</button>
          </div>
        </div>
        <div class="notifications-filters">
          <button class="notification-filter-btn active" data-filter="all" onclick="filterNotifications('all')">All</button>
          <button class="notification-filter-btn" data-filter="unread" onclick="filterNotifications('unread')">Unread</button>
          <button class="notification-filter-btn" data-filter="info" onclick="filterNotifications('info')">Info</button>
          <button class="notification-filter-btn" data-filter="success" onclick="filterNotifications('success')">Success</button>
          <button class="notification-filter-btn" data-filter="warning" onclick="filterNotifications('warning')">Warning</button>
          <button class="notification-filter-btn" data-filter="error" onclick="filterNotifications('error')">Error</button>
        </div>
        <div class="notifications-list" id="notificationsListOverlay">
          <div class="notifications-empty">No notifications</div>
        </div>
      </div>
    </div>

    <!-- Right Panel -->
    <aside class="right-panel">
      <!-- Bug/Todo List Card -->
      <div class="bug-list-card" id="bugListContainer"></div>

      <!-- Health Status Card -->
      <div class="panel-card">
        <div class="panel-header">Health Status</div>
        <div class="health-grid">
          <div class="health-item" id="healthPlan">
            <span class="health-dot"></span>
            <span class="health-label">Plan</span>
            <span class="health-value">-</span>
          </div>
          <div class="health-item" id="healthGit">
            <span class="health-dot"></span>
            <span class="health-label">Git</span>
            <span class="health-value">-</span>
          </div>
          <div class="health-item" id="healthIssues">
            <span class="health-dot"></span>
            <span class="health-label">Issues</span>
            <span class="health-value">-</span>
          </div>
        </div>

        <!-- Blockers Section -->
        <div class="blockers-section" id="blockersSection" style="display:none;">
          <div class="blockers-header">Blockers</div>
          <div class="blockers-list" id="blockersList"></div>
        </div>

        <!-- Pull Requests Section -->
        <div class="pr-section" id="prSection">
          <div class="pr-header">
            <span>Open Pull Requests</span>
            <span class="pr-count" id="prCount">0</span>
          </div>
          <div class="pr-list" id="prList">
            <div class="pr-empty">No open pull requests</div>
          </div>
        </div>

        <!-- Tabs -->
        <div class="about-tabs">
          <div class="about-tab active" onclick="showTab('issues')">Issues</div>
          <div class="about-tab" onclick="showTab('tokens')">Tokens</div>
          <div class="about-tab" onclick="showTab('history')">History</div>
        </div>

        <!-- Issues Tab -->
        <div class="tab-content" id="tabIssues">
          <div class="issues-loading">Loading...</div>
        </div>

        <!-- Tokens Tab -->
        <div class="tab-content" id="tabTokens" style="display:none;">
          <div class="tokens-stats">
            <div class="token-stat">
              <span class="token-value" id="tokenTotal">n/d</span>
              <span class="token-label">Total Tokens</span>
            </div>
            <div class="token-stat">
              <span class="token-value" id="tokenCost">n/d</span>
              <span class="token-label">Est. Cost</span>
            </div>
            <div class="token-stat">
              <span class="token-value" id="tokenCalls">0</span>
              <span class="token-label">API Calls</span>
            </div>
          </div>
          <div class="token-breakdown" id="tokenBreakdown"></div>
        </div>

        <!-- History Tab -->
        <div class="tab-content" id="tabHistory" style="display:none;">
          <div class="history-stats">
            <div class="history-stat">
              <span class="history-value" id="historyVersions">0</span>
              <span class="history-label">Versions</span>
            </div>
            <div class="history-stat">
              <span class="history-value" id="historyEdits">0</span>
              <span class="history-label">Edits</span>
            </div>
          </div>
          <div class="history-timeline" id="historyTimeline">
            <div class="history-empty">No history yet</div>
          </div>
        </div>
      </div>
    </aside>
  </div>

  <!-- Dashboard JS Modules -->
  <script src="js/file-icons.js"></script>
  <script src="js/state.js"></script>
  <script src="js/simplified-nav.js"></script>
  <script src="js/theme.js"></script>
  <!-- Projects Modules -->
  <script src="js/projects-core.js"></script>
  <script src="js/projects-plan.js"></script>
  <script src="js/projects-ui.js"></script>
  <script src="js/consolidated-project-menu.js"></script>
  <!-- GitHub Modules -->
  <script src="js/github-data.js"></script>
  <script src="js/github-render.js"></script>
  <script src="js/github-health.js"></script>
  <script src="js/tabs.js"></script>
  <script src="js/drilldown.js"></script>
  <script src="js/markdown-viewer.js"></script>
  <script src="js/toast.js"></script>
  <script src="js/notifications.js"></script>
  <script src="js/charts.js"></script>
  <script src="js/gantt-core.js"></script>
  <script src="js/gantt-render.js"></script>
  <script src="js/gantt-view.js"></script>
  <script src="js/git-panel.js"></script>
  <script src="js/git-commit-viewer.js"></script>
  <!-- Git Actions Modules -->
  <script src="js/git-actions-basic.js"></script>
  <script src="js/git-actions-staging.js"></script>
  <script src="js/git-actions-branch.js"></script>
  <script src="js/git-watcher.js"></script>
  <script src="js/diff-utils.js"></script>
  <script src="js/diff-viewer.js"></script>
  <!-- Views Modules -->
  <script src="js/views-core.js"></script>
  <script src="js/views-load-kanban.js"></script>
  <script src="js/views-load-waves.js"></script>
  <script src="js/views-kanban.js"></script>
  <script src="js/views-secondary.js"></script>
  <script src="js/unified-waves.js"></script>
  <script src="js/wave-menu.js"></script>
  <!-- Conversation Viewer Modules -->
  <script src="js/conversation-viewer-core.js"></script>
  <script src="js/conversation-viewer-render.js"></script>
  <script src="js/conversation-viewer-live.js"></script>
  <script src="js/bug-tracker.js"></script>
  <!-- Issues Filter Modules -->
  <script src="js/issues-filter-core.js"></script>
  <script src="js/issues-filter-ui.js"></script>
  <script src="js/issues-filter-search.js"></script>
  <script src="js/issues-filter-render.js"></script>
  <script src="js/utils.js"></script>
  <script src="js/render.js"></script>
  <script src="js/system.js"></script>
  <script src="js/menu.js"></script>
  <script src="js/dropdowns.js"></script>
  <script src="js/init.js"></script>
  <!-- Bug Tracker Dropdown -->
    <div class="bug-dropdown" id="bugDropdown" style="display: none;">
    <div class="bug-dropdown-header">
      <span>
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: middle; margin-right: 6px;">
          <rect x="5" y="6" width="14" height="14" rx="2"/>
          <path d="M9 3h6M12 3v3"/>
          <path d="M10 11h6M10 15h6"/>
          <path d="M8 11h.01M8 15h.01"/>
        </svg>
        Track Issues
      </span>
      <button onclick="clearAllBugs()" title="Clear all">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 6h18"/>
          <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"/>
          <path d="M10 11v6M14 11v6"/>
        </svg>
      </button>
    </div>
    <div class="bug-dropdown-input">
      <input type="text" id="bugInput" placeholder="Describe the bug..."
             onkeypress="handleBugInputKeypress(event)" autocomplete="off">
      <select id="bugPriority">
        <option value="low">Low</option>
        <option value="medium" selected>Med</option>
        <option value="high">High</option>
      </select>
      <button onclick="addBug()">Add</button>
    </div>
    <div class="bug-dropdown-list" id="bugItems">
      <div class="bug-dropdown-empty">No bugs tracked</div>
    </div>
    <div class="bug-dropdown-footer">
      <button onclick="createPlanFromBugs()" id="createPlanBtn" disabled>Create Plan</button>
    </div>
  </div>

  </body>
</html>
